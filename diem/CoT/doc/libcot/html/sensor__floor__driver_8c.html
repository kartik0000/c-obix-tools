<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>libcot: sensor_floor_driver.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>sensor_floor_driver.c File Reference</h1><code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;pthread.h&gt;</code><br>
<code>#include &lt;<a class="el" href="curl__ext_8h-source.html">curl_ext.h</a>&gt;</code><br>
<code>#include &lt;lwl_ext.h&gt;</code><br>
<code>#include &lt;ptask.h&gt;</code><br>
<code>#include &lt;ixml_ext.h&gt;</code><br>
<code>#include &lt;xml_config.h&gt;</code><br>
<code>#include &lt;obix_utils.h&gt;</code><br>
<code>#include &lt;<a class="el" href="obix__client_8h-source.html">obix_client.h</a>&gt;</code><br>

<p>
<a href="sensor__floor__driver_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><b>_Target</b></td></tr>

<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="859fabb4e7d088255281300302edf0dc"></a><!-- doxytag: member="sensor_floor_driver.c::SENSOR_FLOOR_CONNECTION" ref="859fabb4e7d088255281300302edf0dc" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>SENSOR_FLOOR_CONNECTION</b>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="c54fcfa933bc1db200f93ab1bc9ec14f"></a><!-- doxytag: member="sensor_floor_driver.c::SENSOR_FLOOR_FEED_CONNECTION" ref="c54fcfa933bc1db200f93ab1bc9ec14f" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>SENSOR_FLOOR_FEED_CONNECTION</b>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="8941590b1604ff89b4975562a7d20e15"></a><!-- doxytag: member="sensor_floor_driver.c::SERVER_CONNECTION" ref="8941590b1604ff89b4975562a7d20e15" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>SERVER_CONNECTION</b>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="c3e32acab74eb5a8dc76eb539eeef876"></a><!-- doxytag: member="sensor_floor_driver.c::TARGET_REMOVE_TIMEOUT" ref="c3e32acab74eb5a8dc76eb539eeef876" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>TARGET_REMOVE_TIMEOUT</b>&nbsp;&nbsp;&nbsp;10000</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="bb3ee5a2c88b3fbfb2635ec8f4175789"></a><!-- doxytag: member="sensor_floor_driver.c::LAST_EVENT_POOL_PERIOD" ref="bb3ee5a2c88b3fbfb2635ec8f4175789" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>LAST_EVENT_POOL_PERIOD</b>&nbsp;&nbsp;&nbsp;3000</td></tr>

<tr><td colspan="2"><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="47b5d12695f8d7474d8c700c690e568d"></a><!-- doxytag: member="sensor_floor_driver.c::Target" ref="47b5d12695f8d7474d8c700c690e568d" args="" -->
typedef struct _Target&nbsp;</td><td class="memItemRight" valign="bottom"><b>Target</b></td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="6b399096b1ed81d3242f96f78444ee74"></a><!-- doxytag: member="sensor_floor_driver.c::target_setX" ref="6b399096b1ed81d3242f96f78444ee74" args="(Target *target, const char *newValue)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>target_setX</b> (Target *target, const char *newValue)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="6f736746e4a803a744c12ca8351a32f2"></a><!-- doxytag: member="sensor_floor_driver.c::target_setY" ref="6f736746e4a803a744c12ca8351a32f2" args="(Target *target, const char *newValue)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>target_setY</b> (Target *target, const char *newValue)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="aa42e53235ac9b7221f97f56fa44a385"></a><!-- doxytag: member="sensor_floor_driver.c::target_get" ref="aa42e53235ac9b7221f97f56fa44a385" args="(int id)" -->
Target *&nbsp;</td><td class="memItemRight" valign="bottom"><b>target_get</b> (int id)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="8b518d9401732f185f3c4767f473dd4b"></a><!-- doxytag: member="sensor_floor_driver.c::target_sendUpdate" ref="8b518d9401732f185f3c4767f473dd4b" args="(Target *target)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>target_sendUpdate</b> (Target *target)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="49eea24055bc9fe8c1c2ea3da43744c1"></a><!-- doxytag: member="sensor_floor_driver.c::parseTarget" ref="49eea24055bc9fe8c1c2ea3da43744c1" args="(IXML_Node *node, int position)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>parseTarget</b> (IXML_Node *node, int position)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="796f0d51edee17a055fcc23b367b09e5"></a><!-- doxytag: member="sensor_floor_driver.c::targetRemoveTask" ref="796f0d51edee17a055fcc23b367b09e5" args="(void *arg)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>targetRemoveTask</b> (void *arg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sensor__floor__driver_8c.html#a677e523cd13677fa416facdfc8e079c">checkTargets</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b665d27d2565c54c252a908fceea7d3e"></a><!-- doxytag: member="sensor_floor_driver.c::targetsListener" ref="b665d27d2565c54c252a908fceea7d3e" args="(int connectionId, int deviceId, int listenerId, const char *newValue)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>targetsListener</b> (int connectionId, int deviceId, int listenerId, const char *newValue)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="9ab4f90f5fafb4fbca62492211144650"></a><!-- doxytag: member="sensor_floor_driver.c::eventFeedListener" ref="9ab4f90f5fafb4fbca62492211144650" args="(int connectionId, int deviceId, int listenerId, const char *newValue)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>eventFeedListener</b> (int connectionId, int deviceId, int listenerId, const char *newValue)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="e8264f086b0404b63e7e1da3f2d817fe"></a><!-- doxytag: member="sensor_floor_driver.c::loadDeviceData" ref="e8264f086b0404b63e7e1da3f2d817fe" args="(IXML_Element *deviceConf)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>loadDeviceData</b> (IXML_Element *deviceConf)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3166c9c32dbfcf851e73465cc5ebbe66"></a><!-- doxytag: member="sensor_floor_driver.c::loadSettings" ref="3166c9c32dbfcf851e73465cc5ebbe66" args="(const char *fileName)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>loadSettings</b> (const char *fileName)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="42815bd748e8dca73d95d5b08f7609bf"></a><!-- doxytag: member="sensor_floor_driver.c::testCycle" ref="42815bd748e8dca73d95d5b08f7609bf" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>testCycle</b> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sensor__floor__driver_8c.html#4e49005f91a10d83468053893ae2a12b">resetTargets</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="02c842348621da035405d2216dc907ad"></a><!-- doxytag: member="sensor_floor_driver.c::checkEventsTask" ref="02c842348621da035405d2216dc907ad" args="(void *args)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>checkEventsTask</b> (void *args)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3c04138a5bfe5d72780bb7e82a18e627"></a><!-- doxytag: member="sensor_floor_driver.c::main" ref="3c04138a5bfe5d72780bb7e82a18e627" args="(int argc, char **argv)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>main</b> (int argc, char **argv)</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3ffd3292564bc3df8ae195388146f3d0"></a><!-- doxytag: member="sensor_floor_driver.c::_deviceData" ref="3ffd3292564bc3df8ae195388146f3d0" args="" -->
IXML_Document *&nbsp;</td><td class="memItemRight" valign="bottom"><b>_deviceData</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="8df5893977370777a28a4216f58097b8"></a><!-- doxytag: member="sensor_floor_driver.c::_targets" ref="8df5893977370777a28a4216f58097b8" args="" -->
Target *&nbsp;</td><td class="memItemRight" valign="bottom"><b>_targets</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="73c566ae717f6c520ccf4370fe5b56fc"></a><!-- doxytag: member="sensor_floor_driver.c::_targetsCount" ref="73c566ae717f6c520ccf4370fe5b56fc" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>_targetsCount</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="bb9f3b6892eeb7b36287b9255ddff62a"></a><!-- doxytag: member="sensor_floor_driver.c::_deviceId" ref="bb9f3b6892eeb7b36287b9255ddff62a" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>_deviceId</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="06279ece79ebb268cec44dfb68171369"></a><!-- doxytag: member="sensor_floor_driver.c::_taskThread" ref="06279ece79ebb268cec44dfb68171369" args="" -->
Task_Thread *&nbsp;</td><td class="memItemRight" valign="bottom"><b>_taskThread</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="7fa64728561e954adc2c910d13d14936"></a><!-- doxytag: member="sensor_floor_driver.c::_targetMutex" ref="7fa64728561e954adc2c910d13d14936" args="" -->
pthread_mutex_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>_targetMutex</b> = PTHREAD_MUTEX_INITIALIZER</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="5d2f5feb672e228256b9d1d036de0c7f"></a><!-- doxytag: member="sensor_floor_driver.c::_curl_handle" ref="5d2f5feb672e228256b9d1d036de0c7f" args="" -->
CURL_EXT *&nbsp;</td><td class="memItemRight" valign="bottom"><b>_curl_handle</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="2f977542907aaf142d8365be7ffa3b72"></a><!-- doxytag: member="sensor_floor_driver.c::_testData" ref="2f977542907aaf142d8365be7ffa3b72" args="" -->
IXML_Document *&nbsp;</td><td class="memItemRight" valign="bottom"><b>_testData</b></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
<dl compact><dt><b><a class="el" href="todo.html#_todo000009">Todo:</a></b></dt><dd>add description here</dd></dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>Andrey Litvinov </dd></dl>
<dl class="version" compact><dt><b>Version:</b></dt><dd>1.0 </dd></dl>

<p>Definition in file <a class="el" href="sensor__floor__driver_8c-source.html">sensor_floor_driver.c</a>.</p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a677e523cd13677fa416facdfc8e079c"></a><!-- doxytag: member="sensor_floor_driver.c::checkTargets" ref="a677e523cd13677fa416facdfc8e079c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int checkTargets           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Checks whether targets are updated. If yes - sends updated values to the server, if no - schedules target removal <dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success, -1 on error </dd></dl>

<p>Definition at line <a class="el" href="sensor__floor__driver_8c-source.html#l00275">275</a> of file <a class="el" href="sensor__floor__driver_8c-source.html">sensor_floor_driver.c</a>.</p>

<p>References <a class="el" href="obix__client_8h-source.html#l00058">OBIX_SUCCESS</a>.</p>

</div>
</div><p>
<a class="anchor" name="4e49005f91a10d83468053893ae2a12b"></a><!-- doxytag: member="sensor_floor_driver.c::resetTargets" ref="4e49005f91a10d83468053893ae2a12b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void resetTargets           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sets all targets at server to not available and removes all target values. 
<p>Definition at line <a class="el" href="sensor__floor__driver_8c-source.html#l00562">562</a> of file <a class="el" href="sensor__floor__driver_8c-source.html">sensor_floor_driver.c</a>.</p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed May 20 15:56:12 2009 for libcot by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
