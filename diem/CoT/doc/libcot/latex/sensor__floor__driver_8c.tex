\hypertarget{sensor__floor__driver_8c}{
\section{sensor\_\-floor\_\-driver.c File Reference}
\label{sensor__floor__driver_8c}\index{sensor\_\-floor\_\-driver.c@{sensor\_\-floor\_\-driver.c}}
}
{\tt \#include $<$stdlib.h$>$}\par
{\tt \#include $<$stdio.h$>$}\par
{\tt \#include $<$pthread.h$>$}\par
{\tt \#include $<$curl\_\-ext.h$>$}\par
{\tt \#include $<$lwl\_\-ext.h$>$}\par
{\tt \#include $<$ptask.h$>$}\par
{\tt \#include $<$ixml\_\-ext.h$>$}\par
{\tt \#include $<$xml\_\-config.h$>$}\par
{\tt \#include $<$obix\_\-utils.h$>$}\par
{\tt \#include $<$obix\_\-client.h$>$}\par
\subsection*{Data Structures}
\begin{CompactItemize}
\item 
struct \textbf{\_\-Target}
\end{CompactItemize}
\subsection*{Defines}
\begin{CompactItemize}
\item 
\hypertarget{sensor__floor__driver_8c_859fabb4e7d088255281300302edf0dc}{
\#define \textbf{SENSOR\_\-FLOOR\_\-CONNECTION}~0}
\label{sensor__floor__driver_8c_859fabb4e7d088255281300302edf0dc}

\item 
\hypertarget{sensor__floor__driver_8c_c54fcfa933bc1db200f93ab1bc9ec14f}{
\#define \textbf{SENSOR\_\-FLOOR\_\-FEED\_\-CONNECTION}~1}
\label{sensor__floor__driver_8c_c54fcfa933bc1db200f93ab1bc9ec14f}

\item 
\hypertarget{sensor__floor__driver_8c_8941590b1604ff89b4975562a7d20e15}{
\#define \textbf{SERVER\_\-CONNECTION}~2}
\label{sensor__floor__driver_8c_8941590b1604ff89b4975562a7d20e15}

\item 
\hypertarget{sensor__floor__driver_8c_c3e32acab74eb5a8dc76eb539eeef876}{
\#define \textbf{TARGET\_\-REMOVE\_\-TIMEOUT}~10000}
\label{sensor__floor__driver_8c_c3e32acab74eb5a8dc76eb539eeef876}

\item 
\hypertarget{sensor__floor__driver_8c_bb3ee5a2c88b3fbfb2635ec8f4175789}{
\#define \textbf{LAST\_\-EVENT\_\-POOL\_\-PERIOD}~3000}
\label{sensor__floor__driver_8c_bb3ee5a2c88b3fbfb2635ec8f4175789}

\end{CompactItemize}
\subsection*{Typedefs}
\begin{CompactItemize}
\item 
\hypertarget{sensor__floor__driver_8c_47b5d12695f8d7474d8c700c690e568d}{
typedef struct \_\-Target \textbf{Target}}
\label{sensor__floor__driver_8c_47b5d12695f8d7474d8c700c690e568d}

\end{CompactItemize}
\subsection*{Functions}
\begin{CompactItemize}
\item 
\hypertarget{sensor__floor__driver_8c_6b399096b1ed81d3242f96f78444ee74}{
void \textbf{target\_\-setX} (Target $\ast$target, const char $\ast$newValue)}
\label{sensor__floor__driver_8c_6b399096b1ed81d3242f96f78444ee74}

\item 
\hypertarget{sensor__floor__driver_8c_6f736746e4a803a744c12ca8351a32f2}{
void \textbf{target\_\-setY} (Target $\ast$target, const char $\ast$newValue)}
\label{sensor__floor__driver_8c_6f736746e4a803a744c12ca8351a32f2}

\item 
\hypertarget{sensor__floor__driver_8c_aa42e53235ac9b7221f97f56fa44a385}{
Target $\ast$ \textbf{target\_\-get} (int id)}
\label{sensor__floor__driver_8c_aa42e53235ac9b7221f97f56fa44a385}

\item 
\hypertarget{sensor__floor__driver_8c_8b518d9401732f185f3c4767f473dd4b}{
int \textbf{target\_\-sendUpdate} (Target $\ast$target)}
\label{sensor__floor__driver_8c_8b518d9401732f185f3c4767f473dd4b}

\item 
\hypertarget{sensor__floor__driver_8c_49eea24055bc9fe8c1c2ea3da43744c1}{
int \textbf{parseTarget} (IXML\_\-Node $\ast$node, int position)}
\label{sensor__floor__driver_8c_49eea24055bc9fe8c1c2ea3da43744c1}

\item 
\hypertarget{sensor__floor__driver_8c_796f0d51edee17a055fcc23b367b09e5}{
void \textbf{targetRemoveTask} (void $\ast$arg)}
\label{sensor__floor__driver_8c_796f0d51edee17a055fcc23b367b09e5}

\item 
int \hyperlink{sensor__floor__driver_8c_a677e523cd13677fa416facdfc8e079c}{checkTargets} ()
\item 
\hypertarget{sensor__floor__driver_8c_b665d27d2565c54c252a908fceea7d3e}{
int \textbf{targetsListener} (int connectionId, int deviceId, int listenerId, const char $\ast$newValue)}
\label{sensor__floor__driver_8c_b665d27d2565c54c252a908fceea7d3e}

\item 
\hypertarget{sensor__floor__driver_8c_9ab4f90f5fafb4fbca62492211144650}{
int \textbf{eventFeedListener} (int connectionId, int deviceId, int listenerId, const char $\ast$newValue)}
\label{sensor__floor__driver_8c_9ab4f90f5fafb4fbca62492211144650}

\item 
\hypertarget{sensor__floor__driver_8c_e8264f086b0404b63e7e1da3f2d817fe}{
int \textbf{loadDeviceData} (IXML\_\-Element $\ast$deviceConf)}
\label{sensor__floor__driver_8c_e8264f086b0404b63e7e1da3f2d817fe}

\item 
\hypertarget{sensor__floor__driver_8c_3166c9c32dbfcf851e73465cc5ebbe66}{
int \textbf{loadSettings} (const char $\ast$fileName)}
\label{sensor__floor__driver_8c_3166c9c32dbfcf851e73465cc5ebbe66}

\item 
\hypertarget{sensor__floor__driver_8c_42815bd748e8dca73d95d5b08f7609bf}{
void \textbf{testCycle} ()}
\label{sensor__floor__driver_8c_42815bd748e8dca73d95d5b08f7609bf}

\item 
void \hyperlink{sensor__floor__driver_8c_4e49005f91a10d83468053893ae2a12b}{resetTargets} ()
\item 
\hypertarget{sensor__floor__driver_8c_02c842348621da035405d2216dc907ad}{
void \textbf{checkEventsTask} (void $\ast$args)}
\label{sensor__floor__driver_8c_02c842348621da035405d2216dc907ad}

\item 
\hypertarget{sensor__floor__driver_8c_3c04138a5bfe5d72780bb7e82a18e627}{
int \textbf{main} (int argc, char $\ast$$\ast$argv)}
\label{sensor__floor__driver_8c_3c04138a5bfe5d72780bb7e82a18e627}

\end{CompactItemize}
\subsection*{Variables}
\begin{CompactItemize}
\item 
\hypertarget{sensor__floor__driver_8c_3ffd3292564bc3df8ae195388146f3d0}{
IXML\_\-Document $\ast$ \textbf{\_\-deviceData}}
\label{sensor__floor__driver_8c_3ffd3292564bc3df8ae195388146f3d0}

\item 
\hypertarget{sensor__floor__driver_8c_8df5893977370777a28a4216f58097b8}{
Target $\ast$ \textbf{\_\-targets}}
\label{sensor__floor__driver_8c_8df5893977370777a28a4216f58097b8}

\item 
\hypertarget{sensor__floor__driver_8c_73c566ae717f6c520ccf4370fe5b56fc}{
int \textbf{\_\-targetsCount}}
\label{sensor__floor__driver_8c_73c566ae717f6c520ccf4370fe5b56fc}

\item 
\hypertarget{sensor__floor__driver_8c_bb9f3b6892eeb7b36287b9255ddff62a}{
int \textbf{\_\-deviceId}}
\label{sensor__floor__driver_8c_bb9f3b6892eeb7b36287b9255ddff62a}

\item 
\hypertarget{sensor__floor__driver_8c_06279ece79ebb268cec44dfb68171369}{
Task\_\-Thread $\ast$ \textbf{\_\-taskThread}}
\label{sensor__floor__driver_8c_06279ece79ebb268cec44dfb68171369}

\item 
\hypertarget{sensor__floor__driver_8c_7fa64728561e954adc2c910d13d14936}{
pthread\_\-mutex\_\-t \textbf{\_\-targetMutex} = PTHREAD\_\-MUTEX\_\-INITIALIZER}
\label{sensor__floor__driver_8c_7fa64728561e954adc2c910d13d14936}

\item 
\hypertarget{sensor__floor__driver_8c_5d2f5feb672e228256b9d1d036de0c7f}{
CURL\_\-EXT $\ast$ \textbf{\_\-curl\_\-handle}}
\label{sensor__floor__driver_8c_5d2f5feb672e228256b9d1d036de0c7f}

\item 
\hypertarget{sensor__floor__driver_8c_2f977542907aaf142d8365be7ffa3b72}{
IXML\_\-Document $\ast$ \textbf{\_\-testData}}
\label{sensor__floor__driver_8c_2f977542907aaf142d8365be7ffa3b72}

\end{CompactItemize}


\subsection{Detailed Description}
\begin{Desc}
\item[\hyperlink{todo__todo000009}{Todo}]add description here\end{Desc}
\begin{Desc}
\item[Author:]Andrey Litvinov \end{Desc}
\begin{Desc}
\item[Version:]1.0 \end{Desc}


Definition in file \hyperlink{sensor__floor__driver_8c-source}{sensor\_\-floor\_\-driver.c}.

\subsection{Function Documentation}
\hypertarget{sensor__floor__driver_8c_a677e523cd13677fa416facdfc8e079c}{
\index{sensor\_\-floor\_\-driver.c@{sensor\_\-floor\_\-driver.c}!checkTargets@{checkTargets}}
\index{checkTargets@{checkTargets}!sensor_floor_driver.c@{sensor\_\-floor\_\-driver.c}}
\subsubsection[checkTargets]{\setlength{\rightskip}{0pt plus 5cm}int checkTargets ()}}
\label{sensor__floor__driver_8c_a677e523cd13677fa416facdfc8e079c}


Checks whether targets are updated. If yes - sends updated values to the server, if no - schedules target removal \begin{Desc}
\item[Returns:]0 on success, -1 on error \end{Desc}


Definition at line 275 of file sensor\_\-floor\_\-driver.c.

References OBIX\_\-SUCCESS.\hypertarget{sensor__floor__driver_8c_4e49005f91a10d83468053893ae2a12b}{
\index{sensor\_\-floor\_\-driver.c@{sensor\_\-floor\_\-driver.c}!resetTargets@{resetTargets}}
\index{resetTargets@{resetTargets}!sensor_floor_driver.c@{sensor\_\-floor\_\-driver.c}}
\subsubsection[resetTargets]{\setlength{\rightskip}{0pt plus 5cm}void resetTargets ()}}
\label{sensor__floor__driver_8c_4e49005f91a10d83468053893ae2a12b}


Sets all targets at server to not available and removes all target values. 

Definition at line 562 of file sensor\_\-floor\_\-driver.c.